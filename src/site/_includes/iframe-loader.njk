{%- if video_type == "clip" %}
  <script>
    (function () {
      let v = document.getElementsByClassName("video-embed");
      for (let n = 0; n < v.length; n++) {
        const p = document.createElement("div");
        p.innerHTML = previewThumb(v[n].dataset.id);
        p.onclick = previewIframe;
        v[n].appendChild(p);
      }
    })();
    function previewThumb(id) {
      return '<img class="preview-image" src="{{ image_card }}"><div class="play-icon"></div>';
    }
    function previewIframe() {
      var iframe = document.createElement("iframe");
      iframe.setAttribute("src", "//clips.twitch.tv/embed?clip=" + this.parentNode.dataset.id);
      iframe.setAttribute("height", "480");
      iframe.setAttribute("width", "854");
      iframe.setAttribute("frameborder", "0");
      iframe.setAttribute("scrolling", "0");
      iframe.setAttribute("allowfullscreen", "1");
      iframe.setAttribute("muted", "0");
      iframe.setAttribute("autoplay", "1");
      iframe.setAttribute("preload", "metadata");
      iframe.setAttribute("class", "resp-iframe");
      iframe.setAttribute("id", "clip-iframe");
      this.parentNode.replaceChild(iframe, this);
    }
  </script>
{%- endif %}

{%- if video_type == "vod" %}
  <script>
    (function () {
      let v = document.getElementsByClassName("video-embed");
      for (let n = 0; n < v.length; n++) {
        const p = document.createElement("div");
        p.innerHTML = previewThumb(v[n].dataset.id);
        p.onclick = previewIframe;
        v[n].appendChild(p);
      }
    })();
    function previewThumb(id) {
      return '<img class="preview-image" src="{{ image_card }}"><div class="play-icon"></div>';
    }
    function previewIframe() {
      var iframe = document.createElement("iframe");
      iframe.setAttribute("src", "//player.twitch.tv/?autoplay=false&video=v" + this.parentNode.dataset.id);
      iframe.setAttribute("height", "480");
      iframe.setAttribute("width", "854");
      iframe.setAttribute("frameborder", "0");
      iframe.setAttribute("scrolling", "0");
      iframe.setAttribute("allowfullscreen", "1");
      iframe.setAttribute("muted", "0");
      iframe.setAttribute("preload", "metadata");
      iframe.setAttribute("class", "resp-iframe");
      iframe.setAttribute("id", "vod-iframe");
      this.parentNode.replaceChild(iframe, this);
    }
  </script>
{%- endif %}

{%- if video_type == "collection" %}
  <script>
    (function () {
      let v = document.getElementsByClassName("video-embed");
      for (let n = 0; n < v.length; n++) {
        const p = document.createElement("div");
        p.innerHTML = previewThumb(v[n].dataset.id);
        p.onclick = previewIframe;
        v[n].appendChild(p);
      }
    })();
    function previewThumb(id) {
      return '<img class="preview-image" src="{{ image_card }}"><div class="play-icon"></div>';
    }
    function previewIframe() {
      var iframe = document.createElement("iframe");
      iframe.setAttribute("src", "//player.twitch.tv/?autoplay=false&collection=" + this.parentNode.dataset.id);
      iframe.setAttribute("height", "480");
      iframe.setAttribute("width", "854");
      iframe.setAttribute("frameborder", "0");
      iframe.setAttribute("scrolling", "0");
      iframe.setAttribute("allowfullscreen", "1");
      iframe.setAttribute("muted", "0");
      iframe.setAttribute("preload", "metadata");
      iframe.setAttribute("class", "resp-iframe");
      iframe.setAttribute("id", "collection-iframe");
      this.parentNode.replaceChild(iframe, this);
    }
  </script>
{%- endif %}
