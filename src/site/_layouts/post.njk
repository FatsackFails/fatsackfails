---
layout: default
---
{#
You Are Here:
- Posts List
- src/site/_layouts/postsList.njk

How It Works:
- On build, this is placed on every page with `{% include "postsList.njk" %}`
- It uses conditions to show Blog data vs Video data

Dynamic Data:
- anything in {{ curly braces }} is a variable from :
  (a) frontmatter in a markdown file from src/site/blog or src/site/highlights
  (b) src/site/_globals
- aliases are defined in `{% set %}`

Gotchas:
- You can't put Nunjucks code inside a <script>

TODO:
1. Improve video script and make the thumbnail load properly (versus undefined)
  - We want to apply the script only `{% if video_type %}`
2. Remove `{{ tldr }} ` if its a video
#}

{% set postCredit = clipper or site.author_name %}

<section class="h-entry flex-1 mx-auto lg:px-32">

  <div class="post-header mb-12 md:mb-20">

    <h1 class="page-title text-3xl md:text-center md:text-5xl lg:text-5xl">{{ title }}</h1>

    <div class="text-sm md:text-base text-gray-600 dark:text-gray-100 flex justify-center">
      <p class="md:text-center">
        <span class="author">By {{ postCredit }}</span>
        <span class="px-2">—</span>
        <time datetime="{{ date }}">{{ date | readableDate }}</time>
        <span class="px-2">—</span>
        <span class="author">Reading Time: {{ content | readingTime }}</span>
        <span class="px-2">—</span>
        {% if tags %}
          <span class="category">Posted in
            {% set separator = joiner(' +') %}
            {% for tag in tags %}
              {%- if tag != "post" -%}
                {% set tagUrl %}/tags/{{ tag | slug }}/{% endset %}
                {{ separator() }} <a href="{{ tagUrl | url }}" rel="tag" class="underline">{{ tag }}</a>
              {%- endif -%}
            {% endfor %}
          </span>
        {% endif %}
      </p>
    </div>

    {# Hero Media #}
    {% if video_type %}
    <div class="resp-container video-embed mt-10 md:mt-8" data-id="{{ video_id }}" data-type="{{ video_type }}" data-thumbnail="{{ image_card }}">
    </div>
    {% elif image_card %}
    <figure class="mt-10 md:mt-8">
      <img src="{{ image_card }}" alt="{{ image_caption }}">
      {% if image_caption %}
        <figcaption class="text-center text-sm italic text-gray-600 dark:text-gray-100 mt-4">{{ image_caption }}</figcaption>
      {% endif %}
    </figure>
    {% endif %}

  </div>

  <div class="content post md:px-16">
    <p class="intro">{{ tldr }}</p>
    {{ content | safe }}
  </div>

</section>

{% if video_type == "clip" %}
  <script>
    (function () {
      let v = document.getElementsByClassName("video-embed");
      for (let n = 0; n < v.length; n++) {
        const p = document.createElement("div");
        p.innerHTML = previewThumb(v[n].dataset.id);
        p.onclick = previewIframe;
        v[n].appendChild(p);
      }
    })();
    function previewThumb(id) {
      return '<img class="preview-image" src="{{ featured_image }}"><div class="play-icon"></div>';
    }
    function previewIframe() {
      var iframe = document.createElement("iframe");
      iframe.setAttribute("src", "//clips.twitch.tv/embed?clip=" + this.parentNode.dataset.id);
      iframe.setAttribute("height", "480");
      iframe.setAttribute("width", "854");
      iframe.setAttribute("frameborder", "0");
      iframe.setAttribute("scrolling", "0");
      iframe.setAttribute("allowfullscreen", "1");
      iframe.setAttribute("muted", "0");
      iframe.setAttribute("autoplay", "1");
      iframe.setAttribute("preload", "metadata");
      iframe.setAttribute("class", "resp-iframe");
      iframe.setAttribute("id", "clip-iframe");
      this.parentNode.replaceChild(iframe, this);
    }
  </script>
{% endif %}

{% if video_type == "vod" %}
  <script>
    (function () {
      let v = document.getElementsByClassName("video-embed");
      for (let n = 0; n < v.length; n++) {
        const p = document.createElement("div");
        p.innerHTML = previewThumb(v[n].dataset.id);
        p.onclick = previewIframe;
        v[n].appendChild(p);
      }
    })();
    function previewThumb(id) {
      return '<img class="preview-image" src="{{ featured_image }}"><div class="play-icon"></div>';
    }
    function previewIframe() {
      var iframe = document.createElement("iframe");
      iframe.setAttribute("src", "//player.twitch.tv/?autoplay=false&video=v" + this.parentNode.dataset.id);
      iframe.setAttribute("height", "480");
      iframe.setAttribute("width", "854");
      iframe.setAttribute("frameborder", "0");
      iframe.setAttribute("scrolling", "0");
      iframe.setAttribute("allowfullscreen", "1");
      iframe.setAttribute("muted", "0");
      iframe.setAttribute("preload", "metadata");
      iframe.setAttribute("class", "resp-iframe");
      iframe.setAttribute("id", "vod-iframe");
      this.parentNode.replaceChild(iframe, this);
    }
  </script>
{% endif %}

{% if video_type == "collection" %}
  <script>
    (function () {
      let v = document.getElementsByClassName("video-embed");
      for (let n = 0; n < v.length; n++) {
        const p = document.createElement("div");
        p.innerHTML = previewThumb(v[n].dataset.id);
        p.onclick = previewIframe;
        v[n].appendChild(p);
      }
    })();
    function previewThumb(id) {
      return '<img class="preview-image" src="{{ featured_image }}"><div class="play-icon"></div>';
    }
    function previewIframe() {
      var iframe = document.createElement("iframe");
      iframe.setAttribute("src", "//player.twitch.tv/?autoplay=false&collection=" + this.parentNode.dataset.id);
      iframe.setAttribute("height", "480");
      iframe.setAttribute("width", "854");
      iframe.setAttribute("frameborder", "0");
      iframe.setAttribute("scrolling", "0");
      iframe.setAttribute("allowfullscreen", "1");
      iframe.setAttribute("muted", "0");
      iframe.setAttribute("preload", "metadata");
      iframe.setAttribute("class", "resp-iframe");
      iframe.setAttribute("id", "collection-iframe");
      this.parentNode.replaceChild(iframe, this);
    }
  </script>
{% endif %}
